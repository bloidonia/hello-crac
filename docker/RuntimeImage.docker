FROM --platform=linux/amd64 ubuntu:18.04
WORKDIR /home/app

RUN apt-get update \
    && apt-get install -y libnl-3-200

COPY --from=checkpoint /azul-crac-jdk /azul-crac-jdk

COPY layers/cr /home/app/cr
COPY layers/libs /home/app/libs
COPY layers/classes /home/app/classes
COPY layers/resources /home/app/resources
COPY layers/application.jar /home/app/application.jar

ENTRYPOINT ["/azul-crac-jdk/bin/java", "-XX:CRaCRestoreFrom=cr"]
